const t=new WeakMap;!("skidata"in Node.prototype)&&Object.defineProperty(Node.prototype,"skidata",{get(){let e=t.get(this);return e||t.set(this,e={}),this.parentNode?Object.setPrototypeOf(e,this.parentNode.skidata):this instanceof Attr&&this.ownerElement?Object.setPrototypeOf(e,this.ownerElement.skidata):e}});const e=Promise.resolve({value:void 0,done:!0});class r{async then(t,e){try{do{var{value:r,done:s}=await this.next()}while(!s);return t(r)}catch(t){e(t)}}}function s(t){const r=function(t){let e;const r=()=>e=t.next().then(s),s=t=>(!t.done&&r(),t);return{throw:t.throw,return:t.return,[Symbol.asyncIterator]:t[Symbol.asyncIterator],next:()=>null!=e?e:r()}}(t[Symbol.asyncIterator]());let s;const n=new Promise((t,i)=>{s={next:()=>Promise.race([r.next(),n]),return:()=>(t(),e),throw:()=>(i(),e),[Symbol.asyncIterator](){return this}}});return s}function n(t){return Object.setPrototypeOf(s(t),r.prototype)}function i(t){return t instanceof Object&&Symbol.asyncIterator in t}async function*a(t,e,r=0){for await(const s of t)yield e(s,r++)}Object.assign(r.prototype,{next(t){return this.__asyncIterator__.next(t)},return(t){return this.__asyncIterator__.return(t)},throw(t){return this.__asyncIterator__.throw(t)}}),Object.defineProperty(r.prototype,"__asyncIterator__",{get(){return Object.defineProperty(this,"__asyncIterator__",{value:this[Symbol.asyncIterator](),enumerable:!1}),this.__asyncIterator__},enumerable:!1}),Object.defineProperties(r,{current:{get(){const t=()=>this.current=this.next().then(e),e=e=>t()&&e;return Object.defineProperty(this,"current",{value:null,writable:!0}),t()}}}),r.prototype.filter=function(t,e){return n("function"==typeof t?async function*(t,e=Boolean,r=0){for await(const s of t)e(s,r++)&&(yield s)}(this,t,e):async function*(t,e){for await(const r of t)r==e&&(yield r)}(this,t))},r.prototype.find=function(t,e){return async function(t,e,r=0){for await(const s of t)if(e(s,r++))return s;return new Promise(()=>{})}(this,t,e)},Object.defineProperties(r,{first:{get(){return this.next().then(({value:t})=>t)}}}),Object.defineProperties(r,{flat:{get(){return n(async function*(t){for await(const e of t)i(e)?yield*e:yield e}(this))}}}),r.prototype.forEach=function(t,e){!async function(t,e,r=0){for await(const s of t)e(s,r++)}(this,t,e)},r.prototype.get=function(t){return function(t,e,r=s){return r(a(t,t=>t[e]))}(this,t,n)},r.prototype.log=function(...t){!async function(t,...e){let r=0;for await(const s of t)console.log(++r+"ยบ",...e,s)}(this,...t)},r.prototype.map=function(t,e){return n(a(this,t,e))},r.prototype.start=function(t){return n(function(t,e){const r=s(t),n=r.next;return r.next=function(){return this.next=n,Promise.resolve({value:e,done:!1})},r}(this,t))},r.prototype.call=function(t,...e){return function(t,e,r=s,...n){return r(a(t,t=>t[e](...n)))}(this,t,n,...e)};const o={next:()=>new Promise(()=>{}),return:()=>e,throw:()=>e,[Symbol.asyncIterator](){return this}};r.prototype.trigger=function(t){return n(async function*(t,e){let r=o;for(;t!==o||r!==o;)yield*await Promise.race([t.next().then(({value:s,done:n})=>n?(t=o,[]):(r.return(),r=e(s),[])),r.next().then(({value:t,done:e})=>e?(r=o,[]):[t])])}(this,t))},r.prototype.reduce=function(t,e){return n(async function*(t,e,r=0){let s=(await t.next()).value;for await(const n of t)yield s=e(s,n,r++)}(this,t,e))};class c extends r{constructor(){super(),this.emitterPromise=new Promise(t=>this.resolve=t);const t=function(...e){t.emit(...e)};return Object.setPrototypeOf(t,this)}async*[Symbol.asyncIterator](){for(;;)yield await this.emitterPromise.then(()=>(this.emitterPromise=new Promise(t=>this.resolve=t),this.value))}emit(t){this.resolve(this.value=t)}}class l extends c{constructor(t,e,r={}){super(),this.element=t,this.type=e,this.options=r,this.handler=t=>{this.options.preventDefault&&t.preventDefault(),this.options.stopPropagation&&t.stopPropagation(),(!this.options.matches||t.target instanceof Element&&t.target.matches(this.options.matches))&&super.emit(t instanceof CustomEvent?t.detail:t)},t.addEventListener(e,this.handler)}matches(t){return this.options.matches=t,this}preventDefault(t=!0){return this.options.preventDefault=t,this}stopPropagation(t=!0){return this.options.stopPropagation=t,this}get target(){return this.map(t=>t.target)}get detail(){return this.map(t=>t.detail)}get skidata(){return this.target.filter(t=>t instanceof Node).map(t=>t.skidata).get}emit(t){this.element.dispatchEvent(new CustomEvent(this.type,{detail:t,bubbles:!0}))}remove(){this.element.removeEventListener(this.type,this.handler)}}const h=Symbol("events");function u(t){return t[h]||(t[h]=new Proxy(t,{has:(t,e)=>"string"==typeof e,get(t,e){return e!=e.toString().toLowerCase()&&console.warn(`Consider using only lowercase letters for event ${e.toString()} name`),e in this?this[e]:"string"==typeof e?this[e]=new l(t,e):void 0}}))}var p;Object.defineProperty(Node.prototype,"events",{get(){return u(this)}}),Object.defineProperty(Node.prototype,"preventDefault",{set(t){t.split(/\s+/).forEach(t=>this.events[t].preventDefault())},get(){return new Proxy(this.events,{set:(t,e,r)=>(t[e].preventDefault(r||void 0===r),!0)})}}),window.events=u(window),function(t){t[t.EQUALS=0]="EQUALS",t[t.PREFIX=1]="PREFIX",t[t.SUFFIX=2]="SUFFIX",t[t.SEPARATOR=3]="SEPARATOR",t[t.CONTAINS=4]="CONTAINS",t[t.SURROUNDING=5]="SURROUNDING"}(p||(p={}));const d={[p.EQUALS]:(t,e)=>`${e} = "${t}"`,[p.PREFIX]:(t,e)=>`starts-with(${e},"${t}")`,[p.SUFFIX]:(t,e)=>`substring(${e},string-length(${e}) - ${t.length-1}) = '${t}'`,[p.SEPARATOR]:(t,e)=>`contains(${e}, '${t}')`,[p.CONTAINS]:(t,e)=>`contains(${e}, '${t}')`,[p.SURROUNDING]:(t,e)=>d[p.PREFIX](t,e)+" and "+d[p.SUFFIX](t,e)},f={[p.EQUALS]:t=>new RegExp("(?=^"+m(t)+"$)"),[p.PREFIX]:t=>new RegExp("^"+m(t)),[p.SUFFIX]:t=>new RegExp(m(t)+"$"),[p.SEPARATOR]:t=>new RegExp(`(?=.+${m(t)}.+)`),[p.CONTAINS]:t=>new RegExp(`(?=.*${m(t)}.*)`),[p.SURROUNDING]:t=>new RegExp(`(?=^${m(t)}.+${m(t)}$)`)},m=t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),y=(t,e,r)=>d[e](t,r),g=(t,e)=>`.//text()[${y(t,e,"normalize-space(.)")}]`;class w{constructor(t){this.root=t,this.mutationObserver=new MutationObserver(t=>t.forEach(t=>this.onChange(t)))}init(){let t=this.constructor;return this.mutationObserver.observe(this.root,{attributeFilter:this.attributeFilter,attributeOldValue:t.attributeOldValue,attributes:t.attributes,characterData:t.characterData,characterDataOldValue:t.characterDataOldValue,childList:t.childList,subtree:t.subtree}),this.updateTree(this.root),this}onChange(t){var e,r;null===(e=t.addedNodes)||void 0===e||e.forEach(this.updateTree,this),null===(r=t.removedNodes)||void 0===r||r.forEach(this.detachTree,this)}disconnect(){this.mutationObserver.disconnect(),this.detachTree(this.root)}}class v extends w{constructor(t,e,r){super(t),this.evaluationSnapshot=!0,this.camelCase=t=>t.replace(/-([a-z])/g,t=>t[1].toUpperCase());let s=((t,e)=>`.//@*[${y(t,e,"name()")}]`)(e,r);this.matches=((t,e)=>f[e](t))(e,r),this.xPathExpression=document.createExpression(s,null)}get evaluationType(){return this.evaluationSnapshot?XPathResult.ORDERED_NODE_SNAPSHOT_TYPE:XPathResult.UNORDERED_NODE_ITERATOR_TYPE}attrName(t){return t.replace(this.matches,"")}*findNodes(t){if(t instanceof DocumentFragment)return t.childNodes.forEach(this.findNodes,this);let e=this.xPathExpression.evaluate(t,this.evaluationType);if(this.evaluationSnapshot)for(let t,r=0;t=e.snapshotItem(r);r++)yield t;else for(let t;t=e.iterateNext();)yield t}updateTree(t){for(let e of this.findNodes(t))this.update(e,this.attrName(e.name))}detachTree(t){for(let e of this.findNodes(t))this.update(e,this.attrName(e.name))}onChange(t){var e,r;null===(e=t.addedNodes)||void 0===e||e.forEach(this.updateTree,this),null===(r=t.removedNodes)||void 0===r||r.forEach(this.detachTree,this),t.attributeName&&this.matches.test(t.attributeName)&&t.target instanceof Element&&this.update(t.target.attributes[t.attributeName],this.attrName(t.attributeName))}}v.attributes=!0,v.childList=!0,v.subtree=!0;class b{}class x{constructor(t,e,r){this.expression=t,this.context=e,this.scope=r,this.original=new Map,this.valueMap=new Map;try{this.function=new Function("__arg0__",`with (__arg0__) return (${this.expression||void 0})`)}catch(e){throw Error(`Creating function() {\n\t${t})\n}\n${e}`)}}async*run(){do{this.original.clear(),this.valueMap.clear();try{let t=this.function.call(this.context,new Proxy(this.scope,this));i(t)?yield*this.original.get(t)||t:yield this.original.get(t)||t}catch(t){if(!(t instanceof b))throw Error(`Evaluating expression (${this.expression})\n${t}`)}await this.deps()}while(this.generators().length>0);this.original.clear(),this.valueMap.clear()}deps(){return Promise.race(this.generators().map(t=>x.generatorPromises.get(t)))}generators(){return Array.from(this.valueMap.keys()).filter(t=>i(t)&&x.generatorPromises.has(t))}get dependencies(){return Array.from(this.valueMap.values())}get entries(){return new Map([...this.valueMap.entries()].map(([t,e])=>[e,t]))}proxy(t){let e=new Proxy(t,this);return this.original.set(e,t),e}register(t,e,r){let s=this.valueMap.get(t);this.valueMap.set(r,s?`${s}.${e}`:e)}get(t,e,r){if(e===Symbol.unscopables)return t[e];if(!(e in t))throw ReferenceError(`${String(e)} is not defined in: ${t}`);let s=i(t)?this.map(t,e):t[e];return this.register(t,String(e),s),i(s)&&(s=this.generatorValue(s)),"object"==typeof s?this.proxy(s):s}map(t,e){const r="__"+String(e)+"__";return t[r]||(t[r]=a(t,t=>t[e]))}generatorValue(t){if(x.generatorValues.has(t))return x.generatorValues.get(t);throw this.watchStream(t),new b}async watchStream(t){this.valueMap.get(t);let e=t[Symbol.asyncIterator]();if(!x.generatorPromises.has(t))try{do{let s=e.next();x.generatorPromises.set(t,s);var r=await s;!r.done&&x.generatorValues.set(t,r.value)}while(!r.done)}finally{x.generatorPromises.delete(t)}}}x.generatorValues=new Map,x.generatorPromises=new Map;class E extends v{update(t,e){if(!t.processed){let r=t.ownerElement;Object.assign(t.skidata,this.prepare(r,t)),this.evaluate(r,t,e,t.value),t.processed=!0}}detach(t){t.skidata.result.return()}async evaluate(t,e,r,s){const n=new x(s,t,e.skidata).run();e.skidata.result=n;for await(let s of n)this.apply(t,r,s,e)}attrSkiData(t,e){return t.attributes[e].skidata}prepare(t,e){return{}}}class P extends E{constructor(t,e=":",r=p.SUFFIX){super(t,e,r)}apply(t,e,r){let s=e.split(".").map(this.camelCase),n=s.pop();s.reduce((t,e)=>t[e],t)[n]=r}}for(let t of["em","ex","px","cm","mm","in","pt","pc","ch","rem","vh","vw","vmin","vmax"])Object.defineProperty(Number.prototype,t,{get(){return this+t}});Object.defineProperty(Number.prototype,"percent",{get(){return this+"%"}});class N extends E{constructor(t,e=".",r=p.PREFIX){super(t,e,r)}apply(t,e,r){let s=e.split(".");for(let e of s)this.toggleClass(t,e,r)}toggleClass(t,e,r){t.classList.toggle(e,r||void 0===r)}}N.evaluationSnapshot=!1;class O extends w{constructor(t,e){super(t),this.name=e}updateTree(t){"querySelectorAll"in t&&t.querySelectorAll(this.name).forEach(this.update,this)}detachTree(t){"querySelectorAll"in t&&t.querySelectorAll(this.name).forEach(this.detach,this)}}O.childList=!0,O.subtree=!0;const S=Symbol("val");class R extends O{constructor(t,e="val"){super(t,e)}async update(t){let e=document.createTextNode("");t.replaceWith(e);let r=new x(t.textContent,e,e.skidata).run();e[S]=r;for await(let t of r)e.textContent=t}detachTree(t){let e,r=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,{acceptNode:t=>S in t?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT},!1);for(;e=r.nextNode();)this.detach(e)}detach(t){t[S].return()}}class T extends E{constructor(t,e){super(t,e,p.EQUALS),this.attr=e,this.attributeFilter=[this.attr],this.defineProperty()}apply(t,e,r){this.set(t,r,t.attributes[e].skidata)}setAttribute(t,e){null!=e&&(t=>t!==Object(t))(e)?e.toString()!=t.getAttribute(this.attr)&&t.setAttribute(this.attr,e):t.removeAttribute(e)}defineProperty(){const t=this.set.bind(this),e=this.attr;e in Element.prototype||Object.defineProperty(Element.prototype,this.attr,{set(r){t(this,r,this.attributes[e].skidata)},enumerable:!1,configurable:!1})}}T.subtree=!0,T.attributes=!0,T.childList=!1;class C extends T{constructor(t,e,r){super(t,e),this.fallback=r}prepare(t){var e;const r=t.tagName.toLowerCase();return{placeholder:this.fallback&&(null===(e=t.nextElementSibling)||void 0===e?void 0:e.matches(`[${this.fallback}]`))&&t.nextElementSibling||document.createComment(`<${r}>hidden</${r}>`)}}set(t,e,{placeholder:r}){this.checkCondiction(e,t)?r.parentNode&&r.replaceWith(t):t.parentNode&&t.replaceWith(r)}}class _ extends C{constructor(t,e="if",r="else"){super(t,e,r)}checkCondiction(t){return t}}class k extends v{constructor(t,e,r="let-",s=p.PREFIX){super(t,r,s),e&&Object.assign(t.skidata,e)}update(t,e){if(!t.processed){let r=t.ownerElement;const s=new x(t.value,r,r.skidata).run();this.apply(r,e,s),t.processed=!0}}detach(){}apply(t,e,r){t.skidata[this.camelCase(e)]=r}}class I extends C{constructor(t,e="unless",r="else"){super(t,e,r)}checkCondiction(t){return void 0!==t&&!t}}class A extends T{constructor(t,e="for",r="of"){super(t,r),this.name=e}prepare(t){let e=document.createDocumentFragment();return e.append(...t.childNodes),{template:e,children:new WeakMap}}set(t,e,r){let s=t.getAttribute(this.name);t.innerHTML="",t.append(...e.map((t,e)=>{let n=this.getNode(r,t);return n.childNodes.forEach(r=>Object.assign(r.skidata,s?{[s]:t,index:e}:t)),n})),delete t.skidata.index}getNode(t,e){let r="object"==typeof e&&t.children.get(e);return r||(r=t.template.cloneNode(!0),"object"==typeof e&&t.children.set(e,r)),r}}class F extends T{constructor(t,e="switch",r="case",s="default"){super(t,e),this.condiction=r,this.fallback=s}prepare(t){return{contents:Array.from(t.children).map(e=>t.removeChild(e))}}match(t,e){return e.find(e=>e.getAttribute(this.condiction)==t)||e.find(t=>t.hasAttribute(this.fallback))||document.createComment("unmatched condiction")}set(t,e,{contents:r}){var s,n;let i=this.match(e,r);null!==(n=null===(s=t.firstElementChild)||void 0===s?void 0:s.replaceWith(i))&&void 0!==n||t.appendChild(i)}}class $ extends v{constructor(t,e="|"){super(t,e,p.SEPARATOR),this.separator=e}update(t,e){if(!t.processed){let r=t.ownerElement,[s,n]=this.camelCase(e).split(this.separator),i=new x(t.value,r,t.skidata);const a=r.events[n];r.events[s].forEach(e=>{Object.assign(t.skidata,{event:e},{}),i.run().next().then(({value:t})=>a(t))}),t.processed=!0}}async update_(t,e){if(!t.processed){const[r,s]=this.camelCase(e).split(this.separator),n=t.ownerElement,i=n.events[r],a=n.events[s];t.skidata.event=i;const o=new x(t.value,n,t.skidata);i.trigger(()=>o.run()).forEach(a),t.processed=!0}}detach(t,e){let[r]=this.camelCase(e).split(this.separator);t.ownerElement.events[r].return()}}$.evaluationSnapshot=!1;class j extends v{constructor(t,e="#",r=p.PREFIX){super(t,e,r)}update(t,e){t.processed||(this.root.skidata[e]=t.ownerElement,t.processed=!0)}detach(t,e){this.root.skidata[e].return()}}class D{constructor(t,e={}){this.all=[new j(t,"#",p.PREFIX),new k(t,e,"let-",p.PREFIX),new A(t,"for","of"),new P(t,":",p.SUFFIX),new N(t,".",p.PREFIX),new _(t,"if","else"),new I(t,"unless","else"),new F(t,"switch","case","default"),new R(t,"val"),new $(t,"|")]}init(){this.all.forEach(t=>t.init())}disconnect(){this.all.forEach(t=>t.disconnect())}}const L=/import\s+?(?:(?:(?:[\w*\s{},]*)\s+from\s+?)|)(?:(?:"(?:.*?)")|(?:'(?:.*?)'))[\s]*?(?:;|$|)/g;async function U(t,e){t=((t,e)=>t.replace(L,t=>{let[r,s,n]=t.split(/'|"/);return`${r}'${new URL(s,e)}'${n}`}))(t,e);let r=new Blob([t],{type:"text/javascript"}),s=URL.createObjectURL(r)+"#";try{return await import(s)}finally{URL.revokeObjectURL(s)}}const X=Symbol();class M{constructor(t=X){this.currentValue=t,this.promise=this.newPromise(),this.get=()=>this.currentValue!=X?this.currentValue:void 0,this.set=t=>(t!==this.currentValue&&(this.resolveNext(this.currentValue=t),this.promise=this.newPromise()),this),this.enumerable=!0,this.configurable=!0}newPromise(){return new Promise(t=>this.resolveNext=t)}async*[Symbol.asyncIterator](){for(this.currentValue!==X&&(yield this.currentValue);;)yield await this.next()}async next(){return await this.promise,this.currentValue}static wrap(t,e){let r=Object.getOwnPropertyDescriptor(t,e),s=r&&M.map.get(r);return s||(s=new M(t[e]),Object.defineProperty(t,e,s),r=Object.getOwnPropertyDescriptor(t,e),M.map.set(r,s)),s}}M.map=new WeakMap;class V extends HTMLElement{constructor(){super(),this.basepath=new URL(location.origin),this.content=document.createDocumentFragment(),this.content.append(...this.childNodes);const t=this.getAttribute("name"),e=this.getAttribute("extends");this.createComponent(t,e)}async createComponent(t,e){const r=e?(await customElements.whenDefined(e),await customElements.get(e)):HTMLElement,s=await Array.from(this.content.querySelectorAll("script[type=module]")).map(t=>t.src?import(new URL(t.src,this.basepath).href):U(t.innerHTML,this.basepath)).reduce(async(t,e)=>Object.assign(await t,await e),Promise.resolve({}));!function(t,e,r,s){var n,i;const a=Object.keys(null!==(n=null==s?void 0:s.properties)&&void 0!==n?n:{}),o=((i=class extends r{constructor(){super();const t=this.attachShadow({mode:"open"});t.append(e.cloneNode(!0)),Object.assign(t.skidata,this.properties=this.buildProperties())}buildProperties(){let t=s?new s(this):{},e=Object.fromEntries(a.map(t=>[t,M.wrap(this,t)]));return Object.defineProperties(t,e),e}connectedCallback(){this.ski=new D(this.shadowRoot,this.skidata)}disconnectedCallback(){var t;null===(t=this.ski)||void 0===t||t.disconnect()}attributeChangedCallback(t,e,r){this.properties[t].set(r)}}).observedAttributes=a,i);customElements.define(t,o)}(t,this.content,r,s.default)}}function W(t="ski-component"){window.customElements.get(t)||customElements.define(t,V)}const H=Symbol("templateEval");class q extends w{constructor(t,e="`",r=p.SURROUNDING){super(t);let s=g(e,r);this.xPathExpression=document.createExpression(s,null)}updateTree(t){let e=this.xPathExpression.evaluate(t,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE);for(let t,r=0;t=e.snapshotItem(r);r++)this.update(t,t.textContent)}detachTree(t){this.detach(t);let e,r=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,{acceptNode:t=>H in t?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT},!1);for(;e=r.nextNode();)this.detach(e)}async update(t,e){let r=new x(e,t,t.skidata).run();t[H]=r,t.textContent="";for await(let e of r)t.textContent=e}detach(t){var e;null===(e=t[H])||void 0===e||e.return()}}q.childList=!0,q.subtree=!0;const G=Symbol("expression");class Q extends w{constructor(t,e="{{",r="}}"){super(t),this.prefix=e,this.suffix=r;let s=g(e,p.CONTAINS);this.xPathExpression=document.createExpression(s,null)}updateTree(t){let e=this.xPathExpression.evaluate(t,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE);for(let t,r=0;t=e.snapshotItem(r);r++)this.splitText(t)}detachTree(t){let e,r=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,{acceptNode:t=>G in t?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT},!1);for(;e=r.nextNode();)this.detach(e)}async splitText(t){let e=t.textContent.indexOf(this.prefix);for(;~e;){let r=t.splitText(e);e=r.textContent.indexOf(this.suffix),t=~e?r.splitText(e+this.suffix.length):r,~e&&this.updateText(r),e=t.textContent.indexOf(this.prefix)}}async updateText(t){const e=t.textContent.substring(this.prefix.length,t.textContent.length-this.suffix.length);let r=new x(e,t,t.skidata).run();t[G]=r,t.textContent="";for await(let e of r)t.textContent=e}detach(t){var e;null===(e=t[G])||void 0===e||e.return()}}function Y(t,e={}){return W("ski-component"),new D(t,e).init()}Q.childList=!0,Q.subtree=!0;export{r as ExtendedAsyncGenerator,p as Rule,P as SkiAssociation,N as SkiClass,$ as SkiEventTrigger,_ as SkiIf,Q as SkiInlineExpression,k as SkiLet,j as SkiName,A as SkiRepeat,F as SkiSwitch,q as SkiTemplateString,I as SkiUnless,R as SkiVal,W as initSkiComponent,Y as skiInit};
